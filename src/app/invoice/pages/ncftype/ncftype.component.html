<div class="row">
  <div class="col-md-4">
    <div
      [ngStyle]="{ borderRadius: '5px' }"
      class="card shadow p-1 mb-7 bg-body rounded"
    >
      <div
        class="card-header bg-primary text-light"
        [ngStyle]="{ borderRadius: '5px' }"
      >
        NCFs
      </div>
      <div class="card-body">
        <form [formGroup]="ncftypeForm">
          <!-- name field  -->
          <div class="form-floating mt-2">
            <select
              [ngStyle]="{ borderRadius: '5px' }"
              required
              class="form-select"
              id="name"
              placeholder="Nombre"
              name="name"
              formControlName="name"
              (change)="filterNcf()"
            >
              <option [value]="ncf.name" *ngFor="let ncf of arrNcfs">
                {{ ncf.name }}
              </option>
            </select>
            <label for="floatingInput">Nombre</label>
            <!-- validation-error -->
            <div
              *ngIf="ncftypeForm.get('name')?.touched && ncftypeForm.get('name')?.errors?.['required']"
              class="alert alert-danger"
            >
              El campo es requerido
            </div>

            <!-- validation-error -->
          </div>

          <!-- typedoc field  -->
          <!-- prefix field  -->
          <div class="row">
            <div class="col-md-6">
              <div class="form-floating mt-2">
                <input
                  [ngStyle]="{ borderRadius: '5px' }"
                  required
                  readonly="true"
                  maxlength="2"
                  name="typedoc"
                  formControlName="typedoc"
                  type="text"
                  class="form-control"
                  id="typedoc"
                  placeholder="Tipo"
                />
                <label for="floatingInput">Tipo</label>
                <!-- validation-error -->
                <div
                  *ngIf="ncftypeForm.get('typedoc')?.touched && ncftypeForm.get('typedoc')?.errors?.['required']"
                  class="alert alert-danger"
                >
                  El campo es requerido
                </div>
                <!-- validation-error -->
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-floating mt-2">
                <input
                  [ngStyle]="{ borderRadius: '5px' }"
                  required
                  readonly="true"
                  maxlength="2"
                  name="prefix"
                  formControlName="prefix"
                  type="text"
                  class="form-control"
                  id="prefix"
                  placeholder="Prefijo"
                />
                <label for="floatingInput">Prefijo</label>
                <!-- validation-error -->
                <div
                  *ngIf="ncftypeForm.get('prefix')?.touched && ncftypeForm.get('prefix')?.errors?.['required']"
                  class="alert alert-danger"
                >
                  El campo es requerido
                </div>
                <!-- validation-error -->
              </div>
            </div>
          </div>

          <!-- inicial_num field  -->
          <div class="form-floating mt-2">
            <input
              [ngStyle]="{ borderRadius: '5px' }"
              required
              readonly="true"
              maxlength="9"
              name="inicial_num"
              formControlName="inicial_num"
              type="number"
              class="form-control"
              id="inicial_num"
              placeholder="Desde"
            />
            <label for="floatingInput">Desde</label>
            <!-- validation-error -->
            <div
              *ngIf="ncftypeForm.get('inicial_num')?.touched && ncftypeForm.get('inicial_num')?.errors?.['required']"
              class="alert alert-danger"
            >
              El campo es requerido
            </div>

            <!-- validation-error -->
          </div>

          <!-- final_num field  -->
          <div class="form-floating mt-2">
            <input
              [ngStyle]="{ borderRadius: '5px' }"
              required
              maxlength="9"
              name="final_num"
              formControlName="final_num"
              type="text"
              class="form-control"
              id="final_num"
              (keypress)="keyPress($event)"
              placeholder="Hasta"
            />

            <label for="floatingInput">Hasta</label>
            <!-- validation-error -->

            <div
              *ngIf="ncftypeForm.get('final_num')?.touched && ncftypeForm.get('final_num')?.errors?.['required']"
              class="alert alert-danger"
            >
              El campo es requerido
            </div>

            <div
              *ngIf="ncftypeForm.get('final_num')?.touched && ncftypeForm.get('final_num')?.errors?.['minlength'] "
              class="alert alert-danger"
            >
              9 digitos son requeridos
            </div>
            <div
              *ngIf="ncftypeForm.get('final_num')?.touched &&   ncftypeForm.get('final_num')?.errors?.['maxlength']"
              class="alert alert-danger"
            >
              9 digitos son requeridos
            </div>
            <!-- validation-error -->
          </div>

          <!-- current_num field  -->
          <div class="form-floating mt-2">
            <input
              [ngStyle]="{ borderRadius: '5px' }"
              required
              readonly="true"
              name="current_num"
              formControlName="current_num"
              type="number"
              class="form-control"
              id="current_num"
              placeholder="Actual"
            />
            <label for="floatingInput">Actual</label>
            <!-- validation-error -->
            <div
              *ngIf="ncftypeForm.get('current_num')?.touched && ncftypeForm.get('current_num')?.errors?.['required']"
              class="alert alert-danger"
            >
              El campo es requerido
            </div>

            <!-- validation-error -->
          </div>

          <!-- expiration field  -->
          <div class="form-floating mt-2">
            <input
              [ngStyle]="{ borderRadius: '5px' }"
              required
              name="expiration"
              formControlName="expiration"
              type="date"
              class="form-control"
              id="expiration"
              placeholder="Vencimiento"
            />
            <label for="floatingInput">Vencimiento</label>
            <!-- validation-error -->
            <div
              *ngIf="ncftypeForm.get('expiration')?.touched && ncftypeForm.get('expiration')?.errors?.['required']"
              class="alert alert-danger"
            >
              El campo es requerido
            </div>
            <div
              *ngIf="ncftypeForm.get('expiration')?.touched && ncftypeForm.get('expiration')?.errors?.['minlength']"
              class="alert alert-danger"
            >
              Se requiere 5 carácteres como mínimo
            </div>
            <div
              *ngIf="ncftypeForm.get('expiration')?.touched && ncftypeForm.get('expiration')?.errors?.['maxlength']"
              class="alert alert-danger"
            >
              Se ha excedido el límite de carácteres
            </div>
            <!-- validation-error -->
          </div>

          <!-- tax field  -->
          <div class="form-floating mt-2">
            <fieldset class="form-group">
              <div class="form-check">
                <input
                  class="form-check-input"
                  #tax
                  name="tax"
                  formControlName="tax"
                  type="checkbox"
                  [value]="tax.value"
                  id="checkbox"
                />
                <label class="form-check-label" for="checkbox">
                  Impuesto
                </label>
              </div>
            </fieldset>
          </div>

          <input type="hidden" name="id" formControlName="id" />
          <input type="hidden" name="status" formControlName="status" />

          <div class="row mt-1">
            <div class="col-md-6">
              <div class="d-grid gap-2 mt-2">
                <a
                  (click)="onNewDoc()"
                  [ngStyle]="{ borderRadius: '5px' }"
                  class="btn btn-info"
                >
                  N u e v o
                </a>
              </div>
            </div>
            <div class="col-md-6">
              <div class="d-grid gap-2 mt-2">
                <button
                  [ngStyle]="{ borderRadius: '5px' }"
                  (click)="onSave()"
                  class="btn btn-primary"
                  [disabled]="ncftypeForm.invalid"
                >
                  G u a r d a r
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="col-md-8">
    <table
      class="table table-bordered border-primary table-sm table-hover mt-1"
    >
      <thead class="bg-primary text-light">
        <tr>
          <th>Nombre</th>
          <th>Tipo</th>
          <th>Secuencia</th>
          <th>Vence</th>
          <th class="text-end">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let ncftype of ncftypes">
          <td>{{ ncftype.name }}</td>
          <td>{{ ncftype.typedoc }}</td>
          <td>{{ ncftype.prefix + ncftype.current_num }}</td>
          <td>{{ ncftype.expiration | date }}</td>
          <td class="text-end">
            <a
              [ngStyle]="{ borderRadius: '5px' }"
              (click)="onEdit(ncftype)"
              class="btn btn-primary btn-sm"
            >
              Editar
            </a>
            <a
              [ngStyle]="{ borderRadius: '5px' }"
              (click)="onUpdateStatus(ncftype)"
              class="btn btn-danger btn-sm mx-1"
            >
              Borrar
            </a>
          </td>
        </tr>
      </tbody>
    </table>
    <div
      [ngStyle]="{ borderRadius: '5px' }"
      class="alert alert-info shadow p-1 mb-7"
    >
      <p class="mb-0">{{ help }}</p>
    </div>
  </div>
</div>
